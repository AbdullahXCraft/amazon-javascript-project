<!DOCTYPE html>

<html>
  <head>
    <title>Exercises 18</title>
  </head>
  <body>
    <script>
      /*
      const xhr = new XMLHttpRequest();

      xhr.addEventListener('load', () => {
        console.log(xhr.response);
      });

      xhr.open('GET', 'https://supersimplebackend.dev/greeting');
      xhr.send();

      fetch('https://supersimplebackend.dev/greeting').then((response) => {
        return response.text();
      }).then((response) => {
        console.log(response);
      });

      async function greetingFetch() {
        try {
          const response = await fetch('https://supersimplebackend.dev/greeting');
          const result = await response.text();
          console.log(result);
        } catch {
          console.log('Unexpected error, Try again later.');
        }
      }
      greetingFetch();

      async function greetingPost() {
        try {
          const response = await fetch('https://supersimplebackend.dev/greeting', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              name: "abdullah"
            })
          });
    
          const result = await response.text();
          console.log(result);
        
        } catch (error) {
          console.log('unexpected error try again later');  
        }
      }
      greetingPost();

      async function amazonFetch() {
        try {
          const response = await fetch('https://amazon.com');
          const result = await response.text();
          console.log(result);
        } catch {
          console.log('CORS error. Your request was blocked by the backend');
        }
      }
      amazonFetch();
      */

      async function greetingPostError() {
        try {
          const response = await fetch('https://supersimplebackend.dev/greeting', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
          });

          if (response.status >= 400) {
            throw response;
          }
    
          const result = await response.text();
          console.log(result);
        
        } catch (error) {
          if (error.status === 400) {
            const errorResponse = await error.json();
            console.log(errorResponse);
          } else {
            console.log('Network error. Please try again later');
          }
        }
      }
      greetingPostError();
    </script>
  </body>
</html>